<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
<nav class="navbar">
  <div class="container-fluid">
    <a class="nav-link nombre" >Acanner</a>
        <div class="menu-icon" (click)="toggleMenu()">
          <div class="bar"></div>
          <div class="bar"></div>
          <div class="bar"></div>
        </div>
        <ul [ngClass]="{'nav': true, 'show-menu': isMenuOpen}">
            <li class="nav-item">
              <a routerLink="/vista-instructor" class="nav-link" aria-current="page">Inicio</a>
            </li>
            <li class="nav-item">
              <a routerLink="/horario" class="nav-link">Horarios</a>
            </li>
            <li class="nav-item">
              <a routerLink="/blog" class="nav-link">Blog</a>
            </li>
            <li class="nav-item">
              <a routerLink="/asistencia" class="nav-link">Asistencias</a>
            </li>
            <div class="dropdown">
              <button class="dropdown-button" (click)="toggleProfileMenu()">
                <span class="material-symbols-outlined">person</span>
              </button>
              <div class="dropdown-content" *ngIf="mostrarMenuPerfil" >
                <li class="nav-item">
                  <a routerLink="/perfil" class="nav-link otro " aria-current="page">Ver Perfil</a>
                </li>
                <li class="nav-item">
                  <a routerLink="/estadisticas" class="nav-link otro ">Estadísticas</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link otro" (click)="logout()">Cerrar Sesión</a>
                </li>
              </div>
            </div> 
        </ul>
  </div>
</nav><br> 
<div class="container"><br>
<div class="crear-actividad">
  <h2 class="subtitulo mt-5">Crear Actividad</h2>
  <form (submit)="createActivity(activityForm)" enctype="multipart/form-data" #activityForm="ngForm">
    <label for="fichaSelect">Seleccionar ficha:</label><br>
    <select [(ngModel)]="selectedFicha" name="selectedFicha" (change)="loadActivities()">
      <option *ngFor="let ficha of fichas" [value]="ficha.identificador">{{ ficha.numeroFicha }}</option>
    </select>    
    <div class="form-group">
      <label for="nombre">Nombre:</label>
      <input type="text" id="nombre" name="nombre" [(ngModel)]="newActivity.nombre" class="form-control" required>
    </div>
    <div class="form-group">
      <label for="comentario">Comentario:</label>
      <textarea id="comentario" name="comentario" [(ngModel)]="newActivity.comentario" class="form-control" required></textarea>
    </div>
    <div class="form-group">
      <label for="fechaInicio">Fecha de Inicio:</label>
      <input type="date" id="fechaInicio" name="fechaInicio" [(ngModel)]="newActivity.fechaInicio" class="form-control" required>
    </div>
    <div class="form-group">
      <label for="fechaFinal">Fecha de Fin:</label>
      <input type="date" id="fechaFinal" name="fechaFinal" [(ngModel)]="newActivity.fechaFinal" class="form-control" required>
    </div>
    <div class="form-group">
      <label for="archivo">Archivo:</label>
      <input type="file" id="archivo" name="archivo" (change)="handleFileInput($event)" class="form-control" required>
    </div>    
    <button type="submit" class="btn btn-crear-actividad">Crear Actividad</button>
  </form>
</div>
  <div *ngIf="errorMessage" class="alert alert-danger mt-3" role="alert">
    {{ errorMessage }}
  </div>
  <div class="lista-actividades">
    <h2 class="subtitulo mt-5">Lista de Actividades</h2>
    <div *ngIf="activityList.length > 0; else noActivities">
      <div class="row">
        <div class="col-md-4" *ngFor="let activity of activityList">
          <div class="card mb-3">
            <div class="card-body">
              <h3 class="card-title">{{ activity.nombre }}</h3>
              <img class="image" src="assets/imagenes/guia.png" alt="Portada">
              <p class="card-text">{{ activity.comentario }}</p>
              <p><strong>Fecha de Inicio:</strong> {{ formatDate(activity.fechaInicio) }}</p>
              <p><strong>Fecha de Fin:</strong> {{ formatDate(activity.fechaFinal) }}</p>
              <div class="button-container">
              <a (click)="descargarArchivo(activity.archivoUrl, activity.nombreArchivo)" type="submit" class="btn btn-primary ver-archivo">Ver archivo</a>
              <button (click)="editActivity(activity)" class="btn btn-primary editar">Editar</button>
              <button (click)="deleteActivity(activity.identificador)" class="btn btn-danger eliminar">Eliminar</button>
            </div><br>
              <div *ngIf="editingActivity && editingActivity.identificador === activity.identificador">
                <form (submit)="updateActivity(editingActivity.identificador)" #editActivityForm="ngForm">
                  <div class="form-group">
                    <label for="nombre">Nombre:</label>
                    <input type="text" id="nombre" name="nombre" [(ngModel)]="editingActivity.nombre" class="form-control" required>
                  </div>
                  <div class="form-group">
                    <label for="comentario">Comentario:</label>
                    <textarea id="comentario" name="comentario" [(ngModel)]="editingActivity.comentario" class="form-control" required></textarea>
                  </div>
                  <div class="form-group">
                    <label for="fechaInicioEdit">Fecha de Inicio:</label>
                    <input type="date" id="fechaInicioEdit" name="fechaInicioEdit" [(ngModel)]="editingActivity.fechaInicio" class="form-control" required>
                  </div>
                  <div class="form-group">
                    <label for="fechaFinalEdit">Fecha de Fin:</label>
                    <input type="date" id="fechaFinalEdit" name="fechaFinalEdit" [(ngModel)]="editingActivity.fechaFinal" class="form-control" required>
                  </div>
                  <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                  <button type="button" (click)="cancelEdit()" class="btn btn-danger">Cancelar</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <ng-template #noActivities>
      <p>No hay actividades disponibles.</p>
    </ng-template>
  </div>
  